# Identifica o workflow no GitHub
name: Lançamento de Versão

# Executa ao atualizar main e dev ou PRs na dev
on:
  push:
    branches: [ main]

# Define o job de teste para rodar no Ubuntu
jobs:
  deploy:
    runs-on: ubuntu-latest

  steps:
  - name: Checkout do Código
    uses: actions/checkout@v5

  - name: Configura Python ${{ matrix.python-version }}
    uses: actions/setup-python@v5
    with:
      python-version: ${{ matrix.python-version }}

  - name: Instala Dependências
    run: |
      python -m pip install --upgrade pip
      pip install -r requirements.txt

  - name: Constrói Pacote
    run: |
      python -m build
  
  - name: Verifica Pacote
    run: |
      twine check dist/*
  
  - name: Publica no PyPI
    uses: pypa/gh-action-pypi-publish@release
    with:
      user: __token__
      password: ${{ secrets.PYPI_API_TOKEN }}
